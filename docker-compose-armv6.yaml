version: '3'

services:

  streamer:
    container_name: lp-detection-streamer
    build:
      context: streamer
      dockerfile: Dockerfile
    image: abarruda/license-plate-reader_streamer
    devices:
      - "/dev/vchiq"
    ports:
      - "8080:80"
    restart: unless-stopped

  openalpr:
    container_name: lp-detection-openalpr
    build:
      context: openalpr
      dockerfile: Dockerfile-armv6
    image: abarruda/license-plate-reader_openalpr
    volumes:
      - ./openalpr/data:/data
    depends_on:
      - streamer
      - control
    restart: unless-stopped

  control:
    container_name: lp-detection-control
    build:
      context: control
      dockerfile: Dockerfile-armv6
    image: abarruda/license-plate-reader_control
    ports:
      - "80"
